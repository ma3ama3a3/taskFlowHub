# 仕様書ドラフト Part2

## 3. 画面仕様

### 3.1. メイン画面

TaskFlow Hubのメイン画面は、ユーザーがタスクを一覧表示し、管理するための主要なインターフェースです。

#### 3.1.1. ヘッダー (`<header class="sticky-header">`)

*   **目的**: アプリケーションのタイトルを表示し、基本的なナビゲーション（現在はユーザーアイコンのみ）を提供します。画面上部に固定表示されます。
*   **表示情報**:
    *   アプリケーションタイトル: 「TaskFlow Hub」 (h1要素)
    *   ユーザーアイコン (Font Awesome の `fa-user-circle`)
*   **主要UIコンポーネント**:
    *   ユーザーアイコンボタン: クリック時の具体的なアクションは現バージョンでは未定義。

#### 3.1.2. フィルターエリア (`<div class="filter-section">`)

*   **目的**: 表示されるタスクを様々な条件で絞り込むためのコントロールを提供します。
*   **表示情報**:
    *   各フィルターコントロールのラベル (キーワード検索, 担当者, 優先度, ステータス, 期限日)
*   **主要UIコンポーネント**:
    *   キーワード検索入力フィールド (`<input type="text" id="searchInput">`): タスク名、説明に含まれる文字列で検索します。
    *   担当者ドロップダウン (`<select id="filterAssignee">`): 担当者を選択してフィルタリングします。
    *   優先度ドロップダウン (`<select id="filterPriority">`): 優先度（高, 中, 低）を選択してフィルタリングします。
    *   ステータスドロップダウン (`<select id="filterStatus">`): ステータスを選択してフィルタリングします。
    *   期限日ドロップダウン (`<select id="filterDueDate">`): 期限日の条件（今日が期限, 明日が期限など）を選択してフィルタリングします。
    *   クリアボタン (`<button id="clearFiltersBtn">`): 全てのフィルター条件をリセットします。

#### 3.1.3. 表示切り替えタブ

*   **目的**: タスクの表示形式をカンバン形式とリスト形式で切り替えるためのタブを提供します。
*   **表示情報**:
    *   各表示形式の名称とアイコン。
*   **主要UIコンポーネント**:
    *   カンバン表示ボタン (`<button id="showKanbanBtn">`): カンバン形式でタスクを表示します。Font Awesome の `fa-columns` アイコンが表示されます。
    *   リスト表示ボタン (`<button id="showListBtn">`): リスト形式でタスクを表示します。Font Awesome の `fa-list-ul` アイコンが表示されます。
    *   アクティブな表示形式のボタンはスタイルが強調されます（`active` クラス）。

#### 3.1.4. タスク作成ボタン (`<button id="openTaskModalBtn">`)

*   **目的**: 新しいタスクを作成するためのモーダルを開きます。
*   **表示情報**:
    *   ボタンテキスト: 「新しいタスクを作成」
    *   アイコン: Font Awesome の `fa-plus` アイコン。
*   **主要UIコンポーネント**:
    *   上記ボタン自体。

#### 3.1.5. カンバンビューエリア (`<div id="kanbanView">`)

*   **目的**: タスクをステータスごとのカラムにカードとして表示します（カンバン形式）。
*   **表示情報**:
    *   ステータスカラム (`<div class="kanban-column" data-status="ステータス名">`): 各ステータス（未着手, 進行中, レビュー待ち, 完了）に対応するカラム。
    *   カラムヘッダー: ステータス名。
    *   タスクカード (`<div class="task-card draggable-card" data-task-id="タスクID">`): 各タスクの情報（タスク名、説明、優先度、期限日、担当者アバター、サブタスク一覧など）を表示します。メインタスクはドラッグ＆ドロップでステータス変更が可能です。
    *   タスクカード内のアクションボタン（複製、編集、削除）。
    *   サブタスク表示エリア（チェックボックス、サブタスク名、編集・削除ボタン）。
*   **主要UIコンポーネント**:
    *   各タスクカード、カラム。
    *   タスクカード内の各種ボタン、サブタスクのチェックボックス。

#### 3.1.6. リストビューエリア (`<div id="listView">`)

*   **目的**: タスクを表形式で一覧表示します。
*   **表示情報**:
    *   テーブルヘッダー (`<thead>`): 各列のタイトル（タスク名, 担当者, 期限日, 優先度, ステータス, アクション）。
    *   タスク行 (`<tbody> <tr class="hover:bg-gray-50">`): 各タスクの情報を1行で表示します。サブタスクはインデントされて表示されます。
    *   表示項目: タスク名（サブタスクの場合はインデントとアイコン）、説明（メインタスクのみ）、担当者、期限日、優先度（アイコンとテキスト）、ステータス（ラベル）。
    *   アクション列 (`<td>`): 編集、削除、複製ボタン。
    *   サブタスク行には完了状態を示すチェックボックスが表示されます。
*   **主要UIコンポーネント**:
    *   タスク情報を表示するテーブル (`<table>`)。
    *   各タスク行のアクションボタン、サブタスクのチェックボックス。

### 3.2. タスク作成・編集モーダル (`<div id="taskModal">`)

*   **目的**: 新規タスクの作成、または既存タスクの編集を行います。
*   **表示情報**:
    *   モーダルタイトル (`<h2 id="modalTitle">`): 「新しいタスクを作成」または「タスクを編集」。
    *   フォームの各入力フィールドのラベル。
    *   タスク名入力フィールドには必須マーク (`<span class="text-red-500">*</span>`)。
    *   タスク名エラーメッセージ (`<p id="taskNameError">`) はバリデーション失敗時に表示。
*   **主要UIコンポーネント**:
    *   閉じるボタン (`<button id="closeTaskModalBtn">`): モーダルを閉じます。
    *   タスクID（非表示） (`<input type="hidden" id="taskId">`): 編集時にタスクIDを保持します。
    *   親タスク選択ドロップダウン (`<select id="taskParent">`): サブタスクとして作成する場合に親タスクを選択します。
    *   タスク名入力フィールド (`<input type="text" id="taskName">`): タスクの名前を入力します（必須）。
    *   説明テキストエリア (`<textarea id="taskDescription">`): タスクの詳細な説明を入力します。
    *   担当者選択ドロップダウン (`<select id="taskAssignee">`): タスクの担当者を選択します。
    *   期限日入力フィールド (`<input type="date" id="taskDueDate">`): タスクの期限日を設定します。
    *   優先度選択ドロップダウン (`<select id="taskPriority">`): 優先度（低, 中, 高）を選択します。
    *   ステータス選択ドロップダウン (`<select id="taskStatusModal">`): タスクのステータスを選択します。
    *   キャンセルボタン (`<button id="cancelTaskBtn">`): 操作をキャンセルしてモーダルを閉じます。
    *   保存ボタン (`<button id="saveTaskBtn">`): 「タスクを作成」または「変更を保存」のテキストが表示され、タスクを保存します。

### 3.3. タスク詳細モーダル (`<div id="taskDetailModal">`)

*   **目的**: タスクの詳細情報を表示し、サブタスクの管理やコメントの閲覧・投稿を行います。
*   **表示情報**:
    *   タスク名 (`<h2 id="taskDetailName">`)
    *   タスク説明 (`<span id="taskDetailDescription">`)
    *   担当者 (`<span id="taskDetailAssignee">`)
    *   期限日 (`<span id="taskDetailDueDate">`)
    *   優先度 (`<span id="taskDetailPriority">`) (アイコンとテキスト)
    *   ステータス (`<span id="taskDetailStatus">`) (ラベル)
    *   親タスクへのリンク (`<div id="parentTaskLinkContainer">`, `<a id="parentTaskLink">`): 親タスクが存在する場合に表示。
    *   サブタスクセクション (`<div id="subtaskDetailContainer">`):
        *   サブタスク一覧: 各サブタスクの名前、完了チェックボックス、編集・削除ボタン。
        *   サブタスクがない場合はその旨のメッセージ。
    *   コメントセクション (`<div id="commentsContainer">`):
        *   コメント一覧: 各コメントの投稿者名、投稿日時、内容、編集・削除ボタン（自分のコメントの場合）。
        *   コメントがない場合はその旨のメッセージ。
*   **主要UIコンポーネント**:
    *   閉じるボタン (`<button id="closeTaskDetailModalBtn">`): モーダルを閉じます。
    *   サブタスク追加ボタン (`<button id="openAddSubtaskModalBtn">`): サブタスク作成モーダルを開きます。
    *   サブタスクの完了チェックボックス、編集ボタン、削除ボタン。
    *   コメント投稿フォーム (`<form id="commentForm">`):
        *   コメント内容入力エリア (`<textarea id="commentContent">`)
        *   コメント投稿ボタン
    *   コメントの編集ボタン、削除ボタン。

## 4. データ仕様

アプリケーション内で扱われる主要なデータ構造について定義します。

### 4.1. タスクオブジェクト

JavaScript内の `tasks` 配列に格納されるオブジェクトで、個々のタスク（メインタスクまたはサブタスク）を表します。

| プロパティ          | データ型        | 説明                                                                 | 例                                                              |
| :------------------ | :-------------- | :------------------------------------------------------------------- | :-------------------------------------------------------------- |
| `id`                | Number          | タスクの一意な識別子。通常は `Date.now()` で生成。                       | `1678886400000`                                                 |
| `name`              | String          | タスクの名称。                                                         | 「TaskFlow Hubの機能改善」                                        |
| `description`       | String          | タスクの詳細な説明。空の場合あり。                                       | 「ユーザーインターフェースの調整と新機能の検討を行う。」           |
| `assignee`          | String          | タスクの担当者名。空文字列の場合は「未割り当て」。                       | 「山田太郎」                                                      |
| `dueDate`           | String          | タスクの期限日。`YYYY-MM-DD` 形式の文字列。空の場合あり。                | 「2025-05-30」                                                  |
| `priority`          | String          | タスクの優先度。「high」（高）、「medium」（中）、「low」（低）のいずれか。 | 「high」                                                        |
| `status`            | String          | タスクのステータス。`STATUSES` 配列内の値のいずれか。                  | 「進行中」                                                      |
| `comments`          | Array           | このタスクに紐づくコメントオブジェクトの配列。初期は空配列の場合あり。   | `[{id: ..., taskId: ..., userName: ..., content: ..., createdAt: ...}]` |
| `parentId`          | Number / `null` | 親タスクのID。メインタスクの場合は `null`。                            | `1678886300000` または `null`                                   |
| `isSubtaskComplete` | Boolean         | サブタスクの場合、その完了状態を示すフラグ。メインタスクでは通常 `false`。 | `true` または `false`                                           |

### 4.2. コメントオブジェクト

タスクオブジェクトの `comments` プロパティに格納されるオブジェクトで、個々のコメントを表します。

| プロパティ    | データ型 | 説明                                           | 例                                     |
| :------------ | :------- | :--------------------------------------------- | :------------------------------------- |
| `id`          | Number   | コメントの一意な識別子。`Date.now()` で生成。    | `1678886400101`                        |
| `taskId`      | Number   | このコメントが紐づくタスクのID。               | `1678886400000`                        |
| `userName`    | String   | コメント投稿者の名前。現在は固定値 "現在のユーザー"。 | 「現在のユーザー」 または 「佐藤花子」 |
| `content`     | String   | コメントの内容。                                 | 「UIの配色案をいくつか提案します。」      |
| `createdAt`   | String   | コメントの作成日時。ISO 8601形式の文字列。     | 「2023-03-15T10:00:00.000Z」           |
| `updatedAt`   | String   | コメントの最終更新日時（編集時に設定）。ISO 8601形式。 | 「2023-03-15T11:00:00.000Z」           |

### 4.3. ステータス定義

タスクが取りうるステータスは、JavaScript内の `STATUSES` 定数配列で定義されています。

*   `STATUSES = ['未着手', '進行中', 'レビュー待ち', '完了']`
    これらの値がタスクオブジェクトの `status` プロパティに設定されます。カンバンビューのカラムやフィルタリングオプションとしても使用されます。

### 4.4. 優先度定義

タスクの優先度は、以下の3段階で管理されます。

*   **高 (`high`)**
*   **中 (`medium`)**
*   **低 (`low`)**

これらの値がタスクオブジェクトの `priority` プロパティに設定されます。タスク作成・編集モーダルでは、`<select id="taskPriority">` で選択され、デフォルトは「中」(`medium`)が選択されています。フィルタードロップダウン (`<select id="filterPriority">`) でも使用されます。

### 4.5. 担当者リスト (初期値)

アプリケーションで初期に選択可能な担当者は、JavaScript内の `ALL_ASSIGNEES` 定数配列で定義されています。

*   `ALL_ASSIGNEES = ['山田太郎', '鈴木一郎', '佐藤花子', '田中次郎']`
    これらの名前が、タスク作成・編集モーダルの担当者選択ドロップダウン (`<select id="taskAssignee">`) およびフィルターの担当者ドロップダウン (`<select id="filterAssignee">`) の選択肢として提供されます。

## 5. 非機能要件 (補足)

### 5.1. 使用技術スタック

*   **フロントエンドUI**:
    *   **Tailwind CSS**: UIコンポーネントのスタイリングにユーティリティファーストのCSSフレームワークであるTailwind CSSを使用しています。(`https://cdn.tailwindcss.com`)
    *   **Font Awesome**: アイコン表示のためにFont Awesomeを使用しています。(`https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css`)
*   **フロントエンドロジック**:
    *   **JavaScript (バニラJS)**: アプリケーションの動的な振る舞いやデータ操作は、特定の外部ライブラリやフレームワーク（例: React, Vue, Angular）に依存しない、標準のJavaScriptで記述されています。
*   **フォント**:
    *   Interフォントファミリー (`font-family: 'Inter', sans-serif;`) が指定されていますが、CDN等からの明示的な読み込み指定は `index.html` 内には見当たりません。ブラウザのデフォルトまたはローカルインストールされたフォントに依存する可能性があります。

### 5.2. データ永続性について (現状の制約)

*   現在のバージョンでは、タスクやコメントなどのデータは、**ブラウザのメモリ上（JavaScriptの `tasks` 配列内）でのみ管理**されています。
*   `localStorage`、`sessionStorage`、またはサーバーサイドのデータベースへの保存処理は実装されていません。
*   そのため、ユーザーがブラウザの**ページをリロードしたり、ブラウザを閉じたりすると、作成・編集・削除したタスクやコメントの情報はすべて失われ、初期状態に戻ります**。

### 5.3. 初期データ

アプリケーションの起動時には、デモンストレーションおよび動作確認用として、以下の初期タスクデータがJavaScriptの `tasks` 配列に設定されています。

*   **タスク1**:
    *   `id`: `Date.now() + 1` (動的に生成)
    *   `name`: 'TaskFlow Hubの機能改善'
    *   `description`: 'ユーザーインターフェースの調整と新機能の検討を行う。'
    *   `assignee`: '山田太郎'
    *   `dueDate`: '2025-05-30'
    *   `priority`: 'high'
    *   `status`: '進行中'
    *   `parentId`: `null`
    *   `isSubtaskComplete`: `false`
    *   `comments`:
        *   コメント1:
            *   `id`: `Date.now() + 101` (動的に生成)
            *   `taskId`: (タスク1のIDと一致)
            *   `userName`: "佐藤花子"
            *   `content`: "UIの配色案をいくつか提案します。"
            *   `createdAt`: (実行時の24時間前の日時)
        *   コメント2:
            *   `id`: `Date.now() + 102` (動的に生成)
            *   `taskId`: (タスク1のIDと一致)
            *   `userName`: "現在のユーザー" (固定値 `CURRENT_USER_NAME`)
            *   `content`: "ありがとうございます。確認します。"
            *   `createdAt`: (実行時の日時)

この初期データにより、ユーザーはアプリケーション起動直後から基本的な機能を確認できます。
